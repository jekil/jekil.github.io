
<!DOCTYPE html>
<html lang="en">
<head>
  <link href="//fonts.googleapis.com/css?family=Indie+Flower|Source+Sans+Pro" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://jekil.sexy/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://jekil.sexy/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://jekil.sexy/theme/font-awesome/css/font-awesome.min.css">


    <link href="http://feeds.feedburner.com/jekil_is_sexy" type="application/atom+xml" rel="alternate" title="Alessandro Tanasi @jekil's blog Atom">



  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="index, follow" />

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<meta name="author" content="jekil" />
<meta name="description" content="Table of Contents 1. Website defacement 2. Anomaly detection systems 2.1 Checksum comparison 2.2 Diff comparison 2.3 DOM tree analysis 2.4 Complex algorithms 3. Signature detection 4. Thresholds and worst cases 1. Website defacement A website defacement is the unauthorized substitution of a web page or a part of it by a system cracker. A defacement is generally meant as a kind of electronic graffiti, although recently it has become a means to spread messages by politically motivated cyber protesters or hacktivists. This is a very common form of attack that seriously damages the trust and …" />
<meta name="keywords" content="defacement, detection, website monitoring">
<meta property="og:site_name" content="Alessandro Tanasi @jekil's blog"/>
<meta property="og:title" content="Website defacement detection techniques"/>
<meta property="og:description" content="Table of Contents 1. Website defacement 2. Anomaly detection systems 2.1 Checksum comparison 2.2 Diff comparison 2.3 DOM tree analysis 2.4 Complex algorithms 3. Signature detection 4. Thresholds and worst cases 1. Website defacement A website defacement is the unauthorized substitution of a web page or a part of it by a system cracker. A defacement is generally meant as a kind of electronic graffiti, although recently it has become a means to spread messages by politically motivated cyber protesters or hacktivists. This is a very common form of attack that seriously damages the trust and …"/>
<meta property="og:locale" content="en_US.UTF-8"/>
<meta property="og:url" content="https://jekil.sexy/blog/2009/website-defacement-detection-techniques.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2009-10-14 00:22:00+01:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://jekil.sexy/author/jekil.html">
<meta property="article:section" content="Research"/>
<meta property="article:tag" content="defacement"/>
<meta property="article:tag" content="detection"/>
<meta property="article:tag" content="website monitoring"/>
<meta property="og:image" content="//en.gravatar.com/userimage/1102835/a961dde28318778e338efdf517ea68cb.png?size=120">

  <title>Alessandro Tanasi @jekil's blog &ndash; Website defacement detection techniques</title>
</head>
<body>
  <aside>
    <div>
      <a href="https://jekil.sexy">
        <img src="//en.gravatar.com/userimage/1102835/a961dde28318778e338efdf517ea68cb.png?size=120" alt="jekil's blog" title="jekil's blog">
      </a>
      <h1><a href="https://jekil.sexy">jekil's blog</a></h1>

<p>Alessandro Tanasi's thoughts</p>
      <nav>
        <ul class="list">
          <li><a href="https://jekil.sexy/pages/about-me/#about-me">About&nbsp;Me</a></li>
          <li><a href="https://jekil.sexy/pages/projects/#projects">Projects</a></li>

        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-envelope-o" href="mailto:alessandro@tanasi.it" target="_blank"><i class="fa fa-envelope-o"></i></a></li>
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/alessandrotanasi" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/jekil" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/jekil" target="_blank"><i class="fa fa-twitter"></i></a></li>
        <li><a class="sc-rss" href="http://feeds.feedburner.com/jekil_is_sexy" target="_blank"><i class="fa fa-rss"></i></a></li>
      </ul>
    </div>
  </aside>
  <main>
    <nav>
      <a href="https://jekil.sexy">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="http://feeds.feedburner.com/jekil_is_sexy">    Atom
</a>

    </nav>

<article class="single">
  <header>
    <h1 id="website-defacement-detection-techniques">Website defacement detection&nbsp;techniques</h1>
    <p>
          Posted on October 14, 2009 in <a href="https://jekil.sexy/category/research.html">Research</a>


        &#8226; 4 min read
    </p>
  </header>
  <div>
    <div class="section" id="table-of-contents">
<h2>Table of&nbsp;Contents</h2>
<div class="line-block">
<div class="line">1. Website defacement</div>
<div class="line">2. Anomaly detection systems</div>
<div class="line">2.1 Checksum comparison</div>
<div class="line">2.2 Diff comparison</div>
<div class="line">2.3 <span class="caps">DOM</span> tree analysis</div>
<div class="line">2.4 Complex algorithms</div>
<div class="line">3. Signature detection</div>
<div class="line">4. Thresholds and worst cases</div>
</div>
</div>
<div class="section" id="website-defacement">
<h2>1. Website&nbsp;defacement</h2>
<div class="line-block">
<div class="line">A website defacement is the unauthorized substitution of a web page or
a part of it by a system cracker. A defacement is generally meant as a
kind of electronic graffiti, although recently it has become a means
to spread messages by politically motivated cyber protesters or
hacktivists.</div>
<div class="line">This is a very common form of attack that seriously damages the trust
and the reputation of a website.</div>
<div class="line">Detecting web page defacements is one of the main services for the
security monitoring system.</div>
<div class="line">A lot of time ago I wrote a small <span class="amp">&amp;</span> smart application to detect web
site defacements in large scale with the ability to monitor a lot
(thousands) of websites. This was a test to collect some statistics,
so I tried to do it in a short time: I wrote it in a few days.</div>
<div class="line">So I was asking me about what techniques and technologies I can use to
get the highest detection rate with the minimum effort.</div>
<div class="line">I choose Ruby, Ruby on Rails for the user interface and Event Machine
to speed up the performances.</div>
<div class="line">With only few days of development I can&#8217;t struggle with complex
algorithms to detect defacements, but I choose some very simple
techniques, that after some months of tests, seemed to be very
effective. The performance and detection rate of this &#8220;poor man&#8221;
techniques are comparable to some others commercial monitoring
systems.</div>
<div class="line">The key feature of the proposed techniques is that it does not require
the installation of a component (like an <span class="caps">HIDS</span>) or a participation of
the site maintainers. It require only the <span class="caps">URL</span> of the web site to
monitor.</div>
<div class="line">Today I want to share this brainstorming about web site detection
techniques.</div>
</div>
</div>
<div class="section" id="anomaly-detection-systems">
<h2>2. Anomaly detection&nbsp;systems</h2>
<div class="line-block">
<div class="line">Anomaly detection refers to detecting patterns in a given data set
that do not conform to an established normal behavior. The patterns
thus detected are called anomalies and often translate to critical and
actionable information in several application domains.</div>
<div class="line">The defacement monitoring application needs to detect a change in a
web page and detect if it&#8217;s &#8220;normal&#8221; or it&#8217;s an &#8220;anomaly&#8221;.</div>
<div class="line">To create a set of &#8220;normal&#8221; a preliminary learning phase builds a
profile of the monitored web page, then the web site can be monitored
for &#8220;anomaly&#8221; changes.</div>
<div class="line">The detection of a defacement is based on a dynamic threshold, if the
web page changed over this threshold the system treat it as defaced
and throw a defacement alert.</div>
<div class="line">This threshold is updated to avoid the obsolescence of his value and
the learning set.</div>
</div>
</div>
<div class="section" id="checksum-comparison">
<h2>2.1 Checksum&nbsp;comparison</h2>
<div class="line-block">
<div class="line">The simplest way to detect a change in some text-formatted data, like
a <span class="caps">HTML</span> page, is to compute and check his checksum with a hash
algorithm like <span class="caps">MD5</span> or <span class="caps">SHA1</span>.</div>
<div class="line">Only a little change in the monitored web page generate a different
checksum, so you can detect a defacement.</div>
<div class="line">This works well for &#8220;best of &#8216;90s&#8221; web sites which uses only static
content, but for today&#8217;s web pages with contents that change at every
reload this technique is quite obsolete.</div>
<div class="line">For example a web page with a counter or a timers inside changes his
content at every reload and the checksum is continually different.</div>
<div class="line">Moreover this type of check cannot observe a threshold based system
because it&#8217;s a comparison with a true or false result.</div>
</div>
</div>
<div class="section" id="diff-comparison">
<h2>2.2 Diff&nbsp;comparison</h2>
<div class="line-block">
<div class="line">There are some libraries in python and ruby implementing the widely
known unix tool diff, using it we can get the difference between two
web pages.</div>
<div class="line">We can use a threshold based system learning the usual difference
percentage of a web page and check if a changeset is under the usual
threshold.</div>
<div class="line">This is a very fast but very effective technique which works well in
most dynamic sites.</div>
</div>
</div>
<div class="section" id="dom-tree-analysis">
<h2>2.3 <span class="caps">DOM</span> tree&nbsp;analysis</h2>
<div class="line-block">
<div class="line">This is a similar strategy to the diff comparison, but is used the <span class="caps">DOM</span>
tree instead of the plain <span class="caps">HTML</span> content for the comparison.</div>
<div class="line">The layout of a website changes, tags and properties, have little
changes during time. Using this fact you can build up a threshold
based system as above.</div>
</div>
</div>
<div class="section" id="complex-algorithms">
<h2>2.4 Complex&nbsp;algorithms</h2>
<p>You can design a lot of algorithms, or use some of the already known,
but this is a very expensive work. I haven&#8217;t used any complex logic or
algorithm but if you want to follow this way you can find a lot of
academic papers about this&nbsp;field.</p>
</div>
<div class="section" id="signature-detection">
<h2>3. Signature&nbsp;detection</h2>
<p>The web pages are examined for pre-configured and predetermined attack
patterns known as signatures. Many attacks today have distinct
signatures. The collection of these signatures must be constantly
updated to mitigate emerging threats. I used the wide database of
<a class="reference external" href="http://www.zone-h.org">Zone-h</a> to build a signature set always&nbsp;updated.</p>
</div>
<div class="section" id="thresholds-and-worst-cases">
<h2>4. Thresholds and worst&nbsp;cases</h2>
<div class="line-block">
<div class="line">The bigger effort is design the engagement rules and tuning good
thresholds.</div>
<div class="line">The percentage of changes in a website can change during time, an
evaluation of both anomaly detection and signature detection
techniques, using a weighted logic can help to reduce false positives.</div>
<div class="line">You must remember that you need to deal with website restyling, layout
changes, widgets and banners that can be removed or added.</div>
<div class="line">As today there are some worst cases that causes false negatives:
defacement done via javascript (levaraging on a <span class="caps">XSS</span> vulnerability) or
via <span class="caps">CSS</span>, or partial defacements (do you remember the securityfocus.com
defacement?) where only a part, like an image or a banner, of the
website changes.</div>
</div>
</div>

  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://jekil.sexy/tag/defacement.html">defacement</a>
      <a href="https://jekil.sexy/tag/detection.html">detection</a>
      <a href="https://jekil.sexy/tag/website-monitoring.html">website monitoring</a>
    </p>
  </div>

  <div class="center social-share">
    <p>    Like this article? Share it with your friends!
</p>
    <div class="addthis_native_toolbox"></div>
    <div class="addthis_sharing_toolbox"></div>
  </div>


<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'jekilsexy';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
</article>

    <footer>
<p>
  &copy; Alessandro Tanasi 2020 - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>
</p>

<p>
</p>    </footer>
  </main>

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2317228-19', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-581885fa6aad787e" async="async"></script>


<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Alessandro Tanasi @jekil's blog ",
  "url" : "https://jekil.sexy",
  "image": "//en.gravatar.com/userimage/1102835/a961dde28318778e338efdf517ea68cb.png?size=120",
  "description": "Alessandro Tanasi's Thoughts and Writings"
}
</script>
</body>
</html>