
<!DOCTYPE html>
<html lang="en">
<head>
  <link href="//fonts.googleapis.com/css?family=Indie+Flower|Source+Sans+Pro" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://jekil.sexy/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://jekil.sexy/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://jekil.sexy/theme/font-awesome/css/font-awesome.min.css">


    <link href="http://feeds.feedburner.com/jekil_is_sexy" type="application/atom+xml" rel="alternate" title="Alessandro Tanasi @jekil's blog Atom">



  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="index, follow" />

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<meta name="author" content="jekil" />
<meta name="description" content="Table of Contents 1. Why you need to enumerate 2. Techniques 2.1 DNS enumeration techniques 2.2 Banner grabbing 2.3 SSL/TLS Protocol enumeration techniques 2.4 HTTP Protocol enumeration techniques 2.5 Passive web enumeration techniques 2.6 Active web enumeration techniques 1. Why you need to enumerate The host name discovery phase is an information gathering act to get a complete and detailed view of target resources and attack points. During an attack or a penetration test, the attacker needs to known  as much information as possible about the entry points to attack. An entry point …" />
<meta name="keywords" content="discovery, dns alias, dns name, enumeration, hostmap, virtual host">
<meta property="og:site_name" content="Alessandro Tanasi @jekil's blog"/>
<meta property="og:title" content="Virtual host and DNS names enumeration techniques"/>
<meta property="og:description" content="Table of Contents 1. Why you need to enumerate 2. Techniques 2.1 DNS enumeration techniques 2.2 Banner grabbing 2.3 SSL/TLS Protocol enumeration techniques 2.4 HTTP Protocol enumeration techniques 2.5 Passive web enumeration techniques 2.6 Active web enumeration techniques 1. Why you need to enumerate The host name discovery phase is an information gathering act to get a complete and detailed view of target resources and attack points. During an attack or a penetration test, the attacker needs to known  as much information as possible about the entry points to attack. An entry point …"/>
<meta property="og:locale" content="en_US.UTF-8"/>
<meta property="og:url" content="https://jekil.sexy/blog/2009/virtual-host-and-dns-names-enumeration-techniques.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2009-01-24 19:36:00+00:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://jekil.sexy/author/jekil.html">
<meta property="article:section" content="Research"/>
<meta property="article:tag" content="discovery"/>
<meta property="article:tag" content="dns alias"/>
<meta property="article:tag" content="dns name"/>
<meta property="article:tag" content="enumeration"/>
<meta property="article:tag" content="hostmap"/>
<meta property="article:tag" content="virtual host"/>
<meta property="og:image" content="//en.gravatar.com/userimage/1102835/a961dde28318778e338efdf517ea68cb.png?size=120">

  <title>Alessandro Tanasi @jekil's blog &ndash; Virtual host and DNS names enumeration techniques</title>
</head>
<body>
  <aside>
    <div>
      <a href="https://jekil.sexy">
        <img src="//en.gravatar.com/userimage/1102835/a961dde28318778e338efdf517ea68cb.png?size=120" alt="jekil's blog" title="jekil's blog">
      </a>
      <h1><a href="https://jekil.sexy">jekil's blog</a></h1>

<p>Alessandro Tanasi's thoughts</p>
      <nav>
        <ul class="list">
          <li><a href="https://jekil.sexy/pages/about-me/#about-me">About&nbsp;Me</a></li>
          <li><a href="https://jekil.sexy/pages/projects/#projects">Projects</a></li>

        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-envelope-o" href="mailto:alessandro@tanasi.it" target="_blank"><i class="fa fa-envelope-o"></i></a></li>
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/alessandrotanasi" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/jekil" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/jekil" target="_blank"><i class="fa fa-twitter"></i></a></li>
        <li><a class="sc-rss" href="http://feeds.feedburner.com/jekil_is_sexy" target="_blank"><i class="fa fa-rss"></i></a></li>
      </ul>
    </div>
  </aside>
  <main>
    <nav>
      <a href="https://jekil.sexy">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="http://feeds.feedburner.com/jekil_is_sexy">    Atom
</a>

    </nav>

<article class="single">
  <header>
    <h1 id="virtual-host-and-dns-names-enumeration-techniques">Virtual host and <span class="caps">DNS</span> names enumeration&nbsp;techniques</h1>
    <p>
          Posted on January 24, 2009 in <a href="https://jekil.sexy/category/research.html">Research</a>


        &#8226; 3 min read
    </p>
  </header>
  <div>
    <div class="section" id="table-of-contents">
<h2>Table of&nbsp;Contents</h2>
<div class="line-block">
<div class="line">1. Why you need to enumerate</div>
<div class="line">2. Techniques</div>
<div class="line">2.1 <span class="caps">DNS</span> enumeration techniques</div>
<div class="line">2.2 Banner grabbing</div>
<div class="line">2.3 <span class="caps">SSL</span>/<span class="caps">TLS</span> Protocol enumeration techniques</div>
<div class="line">2.4 <span class="caps">HTTP</span> Protocol enumeration techniques</div>
<div class="line">2.5 Passive web enumeration techniques</div>
<div class="line">2.6 Active web enumeration techniques</div>
</div>
</div>
<div class="section" id="why-you-need-to-enumerate">
<h2>1. Why you need to&nbsp;enumerate</h2>
<p>The host name discovery phase is an information gathering act to get a
complete and detailed view of target resources and attack&nbsp;points.</p>
<p>During an attack or a penetration test, the attacker needs to known&nbsp; as
much information as possible about the entry points to attack. An entry
point can be identified with an <span class="caps">IP</span> address, a service port, and some
application level information, like the virtual host name in the case of
a web server hosting several&nbsp;sites.</p>
</div>
<div class="section" id="techniques">
<h2>2.&nbsp;Techniques</h2>
<p>There are several techniques that can be used to discover host names and
virtual hosts associated with a <span class="caps">IP</span>&nbsp;address.</p>
<p>Some techniques described here are implemented (and the others will be
implemented soon) in hostmap, a tool that I wrote to discover virtual
hosts and <span class="caps">DNS</span> names of a given <span class="caps">IP</span> address. As of today, the tool is
private (it does not depend on me) but I hope to release it to the
public domain&nbsp;soon.</p>
</div>
<div class="section" id="dns-enumeration-techniques">
<h2>2.1 <span class="caps">DNS</span> enumeration&nbsp;techniques</h2>
<p>The following enumeration techniques are based on the <span class="caps">DNS</span> protocol and&nbsp;are:</p>
<ul class="simple">
<li><strong>Reverse <span class="caps">DNS</span> lookup</strong>: Performs a <span class="caps">PTR</span> request to get the host name
from <span class="caps">IP</span>&nbsp;address.</li>
<li><strong>Name servers record lookup</strong>: Get the authoritative name server for
the target&nbsp;host.</li>
<li><strong>Mail exchange record lookup</strong>: Get the <span class="caps">MX</span> records for the target
host&nbsp;domain.</li>
<li><strong><span class="caps">DNS</span> <span class="caps">AXFR</span> zone transfer</strong>: The name server that serve the target
machine&#8217;s domain zone can be prone to a zone transfer attack. This
allows an attacker to perform an <span class="caps">AXFR</span> <span class="caps">DNS</span> request to retrieve all of the
<span class="caps">DNS</span> records&nbsp;served.</li>
<li><strong>Host name brute forcing</strong>: Using a brute-forcing technique to guess
a host name on the enumerated domain that resolve as the target ip&nbsp;address.</li>
</ul>
</div>
<div class="section" id="banner-grabbing">
<h2>2.2 Banner&nbsp;grabbing</h2>
<p>The services exposed by the target host can disclose a host name in the
response banner. You need to simply telnet in all open ports and wait
for a response banner (or negotiate the application protocol). For
example this is the response banner of a <span class="caps">SMTP</span> server running&nbsp;Postfix:</p>
<div class="highlight"><pre><span></span><span class="gp">$</span> telnet <span class="m">10</span>.0.0.1 <span class="m">25</span>
<span class="go">Trying 10.0.0.1...</span>
<span class="go">Connected to 10.0.0.1.</span>
<span class="go">Escape character is &#39;^]&#39;.</span>
<span class="go">220 mail.example.lan ESMTP Postfix</span>
</pre></div>
<p>As you can see in the response banner you get the host&nbsp;name.</p>
</div>
<div class="section" id="ssl-tls-protocol-enumeration-techniques">
<h2>2.3 <span class="caps">SSL</span>/<span class="caps">TLS</span> Protocol enumeration&nbsp;techniques</h2>
<p>The following enumeration techniques are based on the <span class="caps">SSL</span>/<span class="caps">TLS</span> protocol
and&nbsp;is:</p>
<ul class="simple">
<li><strong>X.509 Certificate</strong>: Often the target machine exposes an <span class="caps">HTTP</span> over
<span class="caps">SSL</span> service. A connection is tried to the common <span class="caps">HTTP</span> service ports and
is tried to negotiate an <span class="caps">SSL</span>/<span class="caps">TLS</span> connection, if the remote server supply
a X.509 certificate the host name is taken from the Common Name (<span class="caps">CN</span>)&nbsp;field.</li>
</ul>
</div>
<div class="section" id="http-protocol-enumeration-techniques">
<h2>2.4 <span class="caps">HTTP</span> Protocol enumeration&nbsp;techniques</h2>
<ul class="simple">
<li><strong>Virtual host brute-forcing</strong>: The web server can be brute-forced to
guess a website served by the target&nbsp;host.</li>
<li><strong>Following redirects</strong>: It is possible to guess another website
served by the target host following redirects (<span class="caps">HTTP</span> code 301 and&nbsp;302).</li>
<li><strong>With error pages</strong>: If you try to get an error page (code 500)
sometimes you can get an error page showing a banner with the host&nbsp;name.</li>
</ul>
</div>
<div class="section" id="passive-web-enumeration-techniques">
<h2>2.5 Passive web enumeration&nbsp;techniques</h2>
<p>The following enumeration techniques are based on third party web sites
and&nbsp;are:</p>
<ul class="simple">
<li><strong>Search engines</strong>: The following search engines can be used and
queried using the target <span class="caps">IP</span> address:<ul>
<li>Microsoft Live (with the dork &#8220;ip:&#8221;): [<a class="reference external" href="http://search.msn.com">http://search.msn.com</a>]</li>
</ul>
</li>
<li><strong><span class="caps">GPG</span>/<span class="caps">PGP</span> key databases</strong>: The following public databases can be used:<ul>
<li><span class="caps">MIT</span> gpg key server: [<a class="reference external" href="http://pgp.mit.edu:11371">http://pgp.mit.edu:11371</a>]</li>
</ul>
</li>
<li><strong><span class="caps">DNS</span>/<span class="caps">WHOIS</span> databases</strong>: Public whois information databases like <span class="caps">RIPE</span>,
or <span class="caps">DNS</span> snapshot database can be used to passively enumerate host name
and track his&nbsp;history.</li>
</ul>
<p>The following is a partial list of public databases that can be&nbsp;used:</p>
<ul class="simple">
<li>Domainsdb: [<a class="reference external" href="http://www.domainsdb.net/">http://www.domainsdb.net/</a>]</li>
<li>Fbk.de: [<a class="reference external" href="http://www.bfk.de/">http://www.bfk.de/</a>]</li>
<li>Gigablast: [<a class="reference external" href="http://www.gigablast.com">http://www.gigablast.com</a>]</li>
<li>Netcraft: [<a class="reference external" href="http://searchdns.netcraft.com">http://searchdns.netcraft.com</a>]</li>
<li>Robtex: [<a class="reference external" href="http://www.robtex.com">http://www.robtex.com</a>]</li>
<li>Tomdns: [<a class="reference external" href="http://www.tomdns.net">http://www.tomdns.net</a>]</li>
<li>Web hosting: [<a class="reference external" href="http://whois.webhosting.info/">http://whois.webhosting.info/</a>]</li>
<li>Web-max: [<a class="reference external" href="http://www.web-max.ca">http://www.web-max.ca</a>]</li>
</ul>
</div>
<div class="section" id="active-web-enumeration-techniques">
<h2>2.6 Active web enumeration&nbsp;techniques</h2>
<ul class="simple">
<li><strong>Crawling</strong>: All published websites can be crawled for links to
other sites and checked (if they resolve as the target <span class="caps">IP</span> address) to
get other sites hosted on the target. This technique is very time&nbsp;consuming.</li>
</ul>
<p><strong><span class="caps">UPDATE</span></strong>: hostmap is a free, automatic, hostnames and virtual hosts
discovery tool written in Python. hostmap has been released in may and
you can get it at
<a class="reference external" href="http://hostmap.sourceforge.net/">http://hostmap.lonerunners.net/</a></p>
</div>

  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://jekil.sexy/tag/discovery.html">discovery</a>
      <a href="https://jekil.sexy/tag/dns-alias.html">dns alias</a>
      <a href="https://jekil.sexy/tag/dns-name.html">dns name</a>
      <a href="https://jekil.sexy/tag/enumeration.html">enumeration</a>
      <a href="https://jekil.sexy/tag/hostmap.html">hostmap</a>
      <a href="https://jekil.sexy/tag/virtual-host.html">virtual host</a>
    </p>
  </div>

  <div class="center social-share">
    <p>    Like this article? Share it with your friends!
</p>
    <div class="addthis_native_toolbox"></div>
    <div class="addthis_sharing_toolbox"></div>
  </div>


<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'jekilsexy';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
</article>

    <footer>
<p>
  &copy; Alessandro Tanasi 2020 - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>
</p>

<p>
</p>    </footer>
  </main>

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2317228-19', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-581885fa6aad787e" async="async"></script>


<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Alessandro Tanasi @jekil's blog ",
  "url" : "https://jekil.sexy",
  "image": "//en.gravatar.com/userimage/1102835/a961dde28318778e338efdf517ea68cb.png?size=120",
  "description": "Alessandro Tanasi's Thoughts and Writings"
}
</script>
</body>
</html>