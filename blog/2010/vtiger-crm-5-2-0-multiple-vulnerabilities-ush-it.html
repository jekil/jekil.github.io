
<!DOCTYPE html>
<html lang="en">
<head>
  <link href="//fonts.googleapis.com/css?family=Indie+Flower|Source+Sans+Pro" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://jekil.sexy/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://jekil.sexy/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://jekil.sexy/theme/font-awesome/css/font-awesome.min.css">


    <link href="http://feeds.feedburner.com/jekil_is_sexy" type="application/atom+xml" rel="alternate" title="Alessandro Tanasi @jekil's blog Atom">



  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="index, follow" />

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<meta name="author" content="jekil" />
<meta name="description" content="With the Ush.it team we published an advisory about “Vtiger CRM 5.2.0 Multiple Vulnerabilities”. The original is here and you can download it here. Vtiger CRM 5.2.0 Multiple Vulnerabilities Name Multiple Vulnerabilities in Vtiger CRM Systems Affected Vtiger CRM 5.2.0 and possibly earlier versions Severity Medium Impact (CVSSv2) Medium 9/10, vector: (AV:N/AC:L/Au:N/C:P/I:P/A:C) Vendor http://www.vtigercrm.com Advisory http://www.ush.it/team/ush/hack-vtigercrm_520/vtigercrm_520.txt Authors Giovanni "evilaliv3" Pellerano (evilaliv3 AT ush DOT it) Alessandro "jekil" Tanasi (alessandro AT …" />
<meta name="keywords" content="vtiger">
<meta property="og:site_name" content="Alessandro Tanasi @jekil's blog"/>
<meta property="og:title" content="Vtiger CRM 5.2.0 Multiple Vulnerabilities @ Ush.it"/>
<meta property="og:description" content="With the Ush.it team we published an advisory about “Vtiger CRM 5.2.0 Multiple Vulnerabilities”. The original is here and you can download it here. Vtiger CRM 5.2.0 Multiple Vulnerabilities Name Multiple Vulnerabilities in Vtiger CRM Systems Affected Vtiger CRM 5.2.0 and possibly earlier versions Severity Medium Impact (CVSSv2) Medium 9/10, vector: (AV:N/AC:L/Au:N/C:P/I:P/A:C) Vendor http://www.vtigercrm.com Advisory http://www.ush.it/team/ush/hack-vtigercrm_520/vtigercrm_520.txt Authors Giovanni "evilaliv3" Pellerano (evilaliv3 AT ush DOT it) Alessandro "jekil" Tanasi (alessandro AT …"/>
<meta property="og:locale" content="en_US.UTF-8"/>
<meta property="og:url" content="https://jekil.sexy/blog/2010/vtiger-crm-5-2-0-multiple-vulnerabilities-ush-it.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2010-12-04 12:52:00+00:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://jekil.sexy/author/jekil.html">
<meta property="article:section" content="Research"/>
<meta property="article:tag" content="vtiger"/>
<meta property="og:image" content="//en.gravatar.com/userimage/1102835/a961dde28318778e338efdf517ea68cb.png?size=120">

  <title>Alessandro Tanasi @jekil's blog &ndash; Vtiger CRM 5.2.0 Multiple Vulnerabilities @ Ush.it</title>
</head>
<body>
  <aside>
    <div>
      <a href="https://jekil.sexy">
        <img src="//en.gravatar.com/userimage/1102835/a961dde28318778e338efdf517ea68cb.png?size=120" alt="jekil's blog" title="jekil's blog">
      </a>
      <h1><a href="https://jekil.sexy">jekil's blog</a></h1>

<p>Alessandro Tanasi's thoughts</p>
      <nav>
        <ul class="list">
          <li><a href="https://jekil.sexy/pages/about-me/#about-me">About&nbsp;Me</a></li>
          <li><a href="https://jekil.sexy/pages/projects/#projects">Projects</a></li>

        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-envelope-o" href="mailto:alessandro@tanasi.it" target="_blank"><i class="fa fa-envelope-o"></i></a></li>
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/alessandrotanasi" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/jekil" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/jekil" target="_blank"><i class="fa fa-twitter"></i></a></li>
        <li><a class="sc-rss" href="http://feeds.feedburner.com/jekil_is_sexy" target="_blank"><i class="fa fa-rss"></i></a></li>
      </ul>
    </div>
  </aside>
  <main>
    <nav>
      <a href="https://jekil.sexy">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="http://feeds.feedburner.com/jekil_is_sexy">    Atom
</a>

    </nav>

<article class="single">
  <header>
    <h1 id="vtiger-crm-5-2-0-multiple-vulnerabilities-ush-it">Vtiger <span class="caps">CRM</span> 5.2.0 Multiple Vulnerabilities &#64;&nbsp;Ush.it</h1>
    <p>
          Posted on December 04, 2010 in <a href="https://jekil.sexy/category/research.html">Research</a>


        &#8226; 4 min read
    </p>
  </header>
  <div>
    <p>With the <a class="reference external" href="http://www.ush.it/">Ush.it</a> team we published an advisory
about “<a class="reference external" href="http://www.ush.it/2010/11/16/vtiger-crm-520-multiple-vulnerabilities/">Vtiger <span class="caps">CRM</span> 5.2.0 Multiple
Vulnerabilities</a>”.
The original
is&nbsp;<a class="reference external" href="http://www.ush.it/2010/11/16/vtiger-crm-520-multiple-vulnerabilities/">here</a>
and you can download it <a class="reference external" href="https://jekil.sexy/public/advisory/hack-vtigercrm_520-2010/vtigercrm_520.txt">here</a>.</p>
<div class="highlight"><pre><span></span>Vtiger CRM 5.2.0 Multiple Vulnerabilities

Name              Multiple Vulnerabilities in Vtiger CRM
Systems Affected  Vtiger CRM 5.2.0 and possibly earlier versions
Severity          Medium
Impact (CVSSv2)   Medium 9/10, vector: (AV:N/AC:L/Au:N/C:P/I:P/A:C)
Vendor            http://www.vtigercrm.com
Advisory          http://www.ush.it/team/ush/hack-vtigercrm_520/vtigercrm_520.txt
Authors           Giovanni &quot;evilaliv3&quot; Pellerano (evilaliv3 AT ush DOT it)
                  Alessandro &quot;jekil&quot; Tanasi (alessandro AT tanasi DOT it)
Date              20101116

I. BACKGROUND

Vtiger CRM is a free, full-featured, 100% Open Source CRM software ideal
for small and medium businesses, with low-cost product support available
to production users that need reliable support.

II. DESCRIPTION

Multiple Vulnerabilities exist in Vtiger CRM software.

III. ANALYSIS

Summary:

A) Remote Code Execution (RCE) Vulnerability
B) Local File Inclusion (LFI) Vulnerability (pre-auth)
C) Cross Site Scripting (XSS) Vulnerabilities (pre-auth, reflected)
D) Cross Site Scripting (XSS) Vulnerabilities (post-auth, reflected)

A) Remote Code Execution (RCE) Vulnerability

A Remote Code Execution vulnerability exists in Vtiger CRM version 5.2.0.
In order to exploit this vulnerability an account on the CRM system is required.

The vulnerability resides in the &quot;Compose Mail&quot; section. The software
permits sending email with attachments and offers a draft save feature.
When this feature is used and an attachment is specified, the
&quot;sanitizeUploadFileName($fileName, $badFileExtensions)&quot; validation routine
is called.

This routine involves some security checks to handle uploaded files, it
does blacklist extension checking and if a bad extension is detected the
txt extension is appended to the file-name.

The blacklist array, defined inside config.inc.php, lacks the &quot;phtml&quot; extension,
well known to be supported by some distributions and packaging, allowing an
attacker to execute the uploaded file and causing the vulnerability.

Below is the blacklist array defined in config.template.php:

--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--

112: $upload_badext = array(&#39;php&#39;, &#39;php3&#39;, &#39;php4&#39;, &#39;php5&#39;, &#39;pl&#39;, &#39;cgi&#39;, &#39;py&#39;,
 &#39;asp&#39;, &#39;cfm&#39;, &#39;js&#39;, &#39;vbs&#39;, &#39;html&#39;, &#39;htm&#39;, &#39;exe&#39;, &#39;bin&#39;, &#39;bat&#39;, &#39;sh&#39;, dll&#39;,
 &#39;phps&#39;);

--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--

For the exploitation methodology for this issue we remand to [1], a
previous advisory of ours.

B) Local File Inclusion (LFI) Vulnerability (pre-auth)

A Local File Inclusion vulnerability exists in Vtiger CRM version 5.2.0.
The vulnerability can be exploited by unauthenticated users.

The vulnerability is present due to insecure statements in the script
phprint.php that forward unfiltered user inputs directly to an include()
function call.

Below are the insecure statements in phprint.php:

--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--

61: $lang_crm = (empty($_GET[&#39;lang_crm&#39;])) ? $default_language : $_GET[&#39;lang_crm&#39;];
62: $app_strings = return_application_language($lang_crm);

--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--

Where the function return_application_language() is defined in
include/utils/utils.php as follows:

--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--

427: function return_application_language($language)
428: {
/.../

435:    @include(&quot;include/language/$language.lang.php&quot;);

   /.../
464: }

--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--

The same issue is also present in graph.php:

--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--

47: if(isset($_REQUEST[&#39;current_language&#39;]))
48: {
49:        $current_language = $_REQUEST[&#39;current_language&#39;];
50: }
51:
52: // retrieve the translated strings.
53: $app_strings = return_application_language($current_language);

--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--

The two vulnerable flaws can be triggered, for example, using:

--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--

curl -kis &quot;http://127.0.0.1/vtigercrm/phprint.php?lang_crm=/../[..]/../
etc/passwd%00&amp;module=a&amp;action=a&amp;activity_mode=

curl -kis &quot;http://127.0.0.1/vtigercrm/graph.php?current_language=/../[..]/../
etc/passwd%00&amp;module=Accounts&amp;action=Import&amp;parenttab=Support&quot;

--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--

C) Cross Site Scripting vulnerabilities (pre-auth, reflected)

A reflected XSS vulnerability exists in Vtiger CRM version 5.2.0.
The vulnerability can be exploited against unauthenticated users only.

The vulnerability is present on the login form, and can be triggered
using these inputs:

- username:  &quot; onmouseover=&quot;javascript:alert(&#39;XSS&#39;);
- password:  &quot; onmouseover=&quot;javascript:alert(&#39;XSS&#39;);

PoC URL that exploits this vulnerability:

--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--

http://127.0.0.1/vtigercrm/index.php?module=Users&amp;action=Login&amp;default_user_name
=%22%20onmouseover=%22javascript:alert(&#39;XSS&#39;);

--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--

D) Cross Site Scripting (XSS) Vulnerabilities (post-auth, reflected)

A reflected XSS vulnerability exists in Vtiger CRM version 5.2.0.
The vulnerability can be exploited against authenticated users only.

The vulnerability is present due to insecure statements in the script
modules/Settings/GetFieldInfo.php that reflect unfiltered user inputs
inside the page output.

PoC URL that exploits this vulnerability:

--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--

http://127.0.0.1/vtigercrm/index.php?module=Settings&amp;action=GetFieldInfo&amp;label
=%3Cscript%3Ealert(123)%3C/scrip%3E

--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--8&lt;--

IV. DETECTION

Vtiger CRM 5.2.0 and possibly earlier versions are vulnerable.

Vtiger CRM can be identified using the following google dork:

- intitle:&quot;vtiger CRM 5 - Commercial Open Source CRM&quot;

V. WORKAROUND

No fix available.

VI. VENDOR RESPONSE

&quot;We were able to reproduce the issues you reported on 5.2,
and are working on releasing a security update shortly.
We expect to release this update within the next 3 to 4 weeks,
after running some more tests.&quot;

VII. CVE INFORMATION

CVE-2010-3909 [A]
CVE-2010-3910 [B]
CVE-2010-3911 [C, D]

VIII. DISCLOSURE TIMELINE

20101009 Bugs discovered
20101012 First vendor contact
20101012 Vendor response (Sreenivas Kanumuru)
20101012 Contacted Steven M. Christey (mitre.org)
20101012 CVEs assigned by Steven M. Christey
20100102 Vtiger CRM team confirms vulnerability (Sreenivas Kanumuru)
20101015 Advisory release scheduled for 20101115
20101116 Advisory released

IX. REFERENCES

[1] Vtiger CRM 5.0.4 Multiple Vulnerabilities
http://www.ush.it/team/ush/hack-vtigercrm_504/vtigercrm_504.txt

X. CREDIT

Giovanni &quot;evilaliv3&quot; Pellerano, Alessandro &quot;jekil&quot; Tanasi are credited
with the discovery of this vulnerability.

Giovanni &quot;evilaliv3&quot; Pellerano
web site: http://www.ush.it/, http://www.evilaliv3.org/
mail: evilaliv3 AT ush DOT it

Alessandro &quot;jekil&quot; Tanasi
web site: http://www.tanasi.it/
mail: alessandro AT tanasi DOT it

XI. LEGAL NOTICES

Copyright (c) 2010 Francesco &quot;ascii&quot; Ongaro

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without mine express
written consent. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please email me for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
</pre></div>

  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://jekil.sexy/tag/vtiger.html">vtiger</a>
    </p>
  </div>

  <div class="center social-share">
    <p>    Like this article? Share it with your friends!
</p>
    <div class="addthis_native_toolbox"></div>
    <div class="addthis_sharing_toolbox"></div>
  </div>


<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'jekilsexy';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
</article>

    <footer>
<p>
  &copy; Alessandro Tanasi 2020 - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>
</p>

<p>
</p>    </footer>
  </main>

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2317228-19', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-581885fa6aad787e" async="async"></script>


<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Alessandro Tanasi @jekil's blog ",
  "url" : "https://jekil.sexy",
  "image": "//en.gravatar.com/userimage/1102835/a961dde28318778e338efdf517ea68cb.png?size=120",
  "description": "Alessandro Tanasi's Thoughts and Writings"
}
</script>
</body>
</html>